<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Untitled Document</title>



<!-- =======================================pdf reader script start ======================== -->    
<script src="../../phonegap.js"></script>


<script src="viewer.js" type="text/javascript" charset="utf-8"></script>
<script src="PluginLoader.js" type="text/javascript" charset="utf-8"></script>
<script src="../../js/jquery.js"></script>
<script src="../../js/jquery.mobile-1.4.2.js"></script>
<script src="base64-binary.js"></script>


<script>



$( document ).bind( "mobileinit", function() {
    // Make your jQuery Mobile framework configuration changes here!
    $.support.cors = true;
    $.mobile.allowCrossDomainPages = true; 
});


//			 	var location = '#egc.pdf';
//			 window.location.hash = '#egc.pdf';

//alert ("test");
//\xampp\htdocs\b\pdf_file

var location1=localStorage.bookname;
alert(location1);
//var location1='/C:/xampp/htdocs/b/pdf_file/egc.pdf';

//var location1='egc.pdf';
 //location1=location1.slice(1);

//alert(location1);

//location1=location1.replace("file://","");
//alert(location1+'!!!!!!!!!!!!!!!!!!!');
//alert(location1+'------replace');
//location1='all.pdf';
loadDocument(location1);
</script>
<!-- =======================================pdf reader script end ======================== -->            

</head>



<body>
<div id = "viewer" style="height:0px; overflow:hidden" >
           <div id = "titlebar">
                <div id = "documentName"></div>
           </div>
           <div id = "toolbarContainer">
                <div id = "toolbar">
                    <div id = "toolbarLeft">
                        <div id = "navButtons" class = "splitToolbarButton">
                            <button id = "previous" class = "toolbarButton pageUp" title = "Previous Page">previous</button>
                            <div class="splitToolbarButtonSeparator"></div>
                            <button id = "next" class = "toolbarButton pageDown" title = "Next Page">next</button>
                        </div>
                        <label id = "pageNumberLabel" class = "toolbarLabel" for = "pageNumber">Page:</label>
                        <input type = "number" id = "pageNumber" class = "toolbarField pageNumber" /></input>
                        <span id = "numPages" class = "toolbarLabel"></span>
                    </div>
                    <div id = "toolbarMiddleContainer" class = "outerCenter">
                        <div id = "toolbarMiddle" class = "innerCenter">
                            
                            <span id="scaleSelectContainer" class="dropdownToolbarButton">
                                <select id="scaleSelect" title="Zoom" oncontextmenu="return false;">
                                    <option id="pageAutoOption" value="auto" selected>Automatic</option>
                 <!--               <option id="pageActualOption" value="page-actual">Actual Size</option>
                                    <option id="pageWidthOption" value="page-width">Full Width</option>
                                    <option id="customScaleOption" value="custom"></option>
                                    <option value="0.5">50%</option>
                                    <option value="0.75">75%</option>
                                    <option value="1">100%</option>
                                    <option value="1.25">125%</option>
                                    <option value="1.5">150%</option>
                                    <option value="2">200%</option>
                 -->               </select>
                            </span>
                            
                        </div>
                    </div>
                </div>
            </div>
            <div id = "canvasContainer">
                
            </div>
            
            
        </div>

<div id="loader" style="display:none; position:fixed; top:45%; left:47%; ">
<img src="loader.gif"  />
</div>
<script src="write.js" ></script>
<script>	



function display_pages(){
	
	
var g = document.getElementById('numPages');
var str = g.textContent;
//alert(str);
var h = parseInt(str.substring(3));
//alert(g.textContent);
//alert(h);

// Creating an example of JSON
//var session = {'screens' : []};

window.requestFileSystem(LocalFileSystem.PERSISTENT, 0, function(fileSystem) {
	
	
	
	var filename = localStorage.filename
	var foldername = "myappfolder/"+ filename; 
	
   
   fileSystem.root.getDirectory(foldername, {create: true, exclusive: false}, function(directory) {
	   



	   
setTimeout(function(){
	
	for(var k=1;k<=h;k++){
	
var pageno = k;


 window.canvas2ImagePlugin.saveImageDataToLibrary(function(msg){
			
		
			msg = "file://" + msg;
			
			
			 window.resolveLocalFileSystemURI(msg, function(file) {
				 		
				
				 var FileName = k + ".png";
				 
				
				 				 
			 file.copyTo(directory,FileName);
			 
			 },fail);
			 
			
        },function(){
			
            alert("error in converting image");
			
        },document.getElementById( 'canvas'+ pageno)
    );



}
 },10000);

redirect();




   },fail);
   
},fail);


function successMove(){
				 
				 
			 }
			 function resOnError1(){
				 
				 alert("error");
			 }
			

function fail(){
alert("fail");	
	
}

//var chummaoru = new Date();
//alert(chummaoru);

}


function redirect()
{
	$('#loader').hide();
	
	alert("your file has been imported successfully ");	
	window.location='../../index.html';
	}


</script>
</body>
</html>
